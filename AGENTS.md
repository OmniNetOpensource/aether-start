# Repository Guidelines

## Project Structure & Module Organization
- `src/routes/` contains TanStack Start file-based routes (UI pages and API handlers). Dynamic segments use `$` (example: `src/routes/app/c/$conversationId.tsx`).
- `src/routeTree.gen.ts` is auto-generated by TanStack Router; do not edit it manually.
- Core business modules live in `src/features/` (chat, conversation, sidebar, theme, responsive).
- UI components in `src/components/` and `src/components/ui/`; utilities in `src/lib/`; hooks in `src/hooks/`; stores in `src/stores/`.
- Server-only helpers live in `src/server/`; database migrations are in `migrations/`; deploy scripts are in `scripts/`.
- Static assets go in `public/`.

## Build, Test, and Development Commands
Use `pnpm` for all tasks.
- `pnpm install` - Install dependencies
- `pnpm dev` - Start local dev server on port 3000
- `pnpm build` - Build production bundle
- `pnpm check` - Run type-check, lint, and build together
- `pnpm cf:typegen` - Regenerate Cloudflare worker bindings types
- `pnpm cf:migrate:local` - Apply D1 migrations locally
- `pnpm cf:migrate:remote` - Apply D1 migrations remotely
- `pnpm cf:deploy` - Build and deploy to Cloudflare Workers


## Coding Style & Naming Conventions
- TypeScript + React; follow existing patterns (2-space indent, single quotes, no semicolons).
- Components use PascalCase (`MessageList.tsx`), hooks use `useX` naming, and stores use `*Store`.
- Route file names mirror paths (e.g., `index.tsx`, `__root.tsx`, `$param.tsx`).
- Keep changes ESLint-clean; lint rules live in `eslint.config.mjs`.

## Configuration & Secrets
- Local secrets live in `.env.local` (for example: `ANTHROPIC_API_KEY`, `ANTHROPIC_BASE_URL`, `SERP_API_KEY`, `JINA_API_KEY`, `SUPADATA_API_KEY`).
- Cloudflare bindings are configured in `wrangler.jsonc` (`DB` for D1, `CHAT_ASSETS` for R2).
- Never commit real secrets; `NEXT_PUBLIC_*` values are exposed to the client.

