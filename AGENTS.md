# Repository Guidelines

## Project Structure & Module Organization
- `src/app/` contains the TanStack Start, file-based routes (UI pages and API routes under `src/app/api/`). Dynamic segments use `$` (example: `src/app/app/c/$conversationId`).
- `src/routeTree.gen.ts` is auto-generated by TanStack Router; do not edit it manually.
- Core modules live in `src/features/`, `src/components/`, `src/hooks/`, `src/stores/`, `src/providers/`, `src/lib/`, and `src/data/`.
- Shared UI primitives/helpers are in `components/ui/` and `lib/utils.ts`.
- Static assets go in `public/`; shared types live in `types/`; server-only helpers live in `src/server/`.
- `src/routes/demo/` holds demo routes that can be removed if unused.

## Build, Test, and Development Commands
Use `pnpm` for all tasks.
- `pnpm install` installs dependencies.
- `pnpm dev` runs the Vite dev server on port 3000.
- `pnpm build` creates a production build.
- `pnpm preview` serves the production build locally.
- `pnpm test` runs Vitest in jsdom.
- `pnpm lint` runs ESLint.
- `pnpm type-check` runs `tsc --noEmit`.
- `pnpm check` runs type-check, lint, and build.

## Coding Style & Naming Conventions
- TypeScript + React; follow existing patterns (2-space indent, single quotes, no semicolons).
- Components use PascalCase (`MessageList.tsx`), hooks use `useX` naming, and stores use `*Store`.
- Route file names mirror paths (e.g., `index.tsx`, `__root.tsx`, `$param.tsx`).
- Keep changes ESLint-clean; lint rules live in `eslint.config.mjs`.

## Testing Guidelines
- Use Vitest + Testing Library; test files live next to code as `*.test.tsx` (example: `src/components/Markdown.test.tsx`).
- Add tests for new UI states, async flows, or provider logic; update snapshots only with intent.

## Configuration & Secrets
- Local secrets live in `.env.local` (API keys for OpenAI/OpenRouter/Anthropic/Gemini/Serp/Jina and Convex URLs).
- Never commit real secrets; `NEXT_PUBLIC_*` values are exposed to the client.

## Commit & Pull Request Guidelines
- Commit messages are short and imperative; optional conventional prefixes like `feat:` or `fix:` appear in history.
- PRs should include: a clear summary, testing notes (`pnpm test` or `pnpm check`), and screenshots for UI changes.
- Link relevant issues and call out any config or env changes.
